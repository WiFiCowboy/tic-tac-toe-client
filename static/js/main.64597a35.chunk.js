(this["webpackJsonpcapstone-client"]=this["webpackJsonpcapstone-client"]||[]).push([[0],{24:function(e,t,a){e.exports=a(41)},29:function(e,t,a){},30:function(e,t,a){},31:function(e,t,a){},32:function(e,t,a){},38:function(e,t,a){},39:function(e,t,a){},40:function(e,t,a){},41:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(20),o=a.n(s),c=a(8),i=(a(29),a(1)),l=a(2),u=a(4),m=a(3),h=a(5),d=a(11),f=a(23);var p=function(e){return r.a.createElement("button",{className:"square",onClick:e.onClick},e.value)},v=function(e){function t(){return Object(i.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(l.a)(t,[{key:"renderSquare",value:function(e){var t=this;return r.a.createElement(p,{value:this.props.squares[e],onClick:function(){return t.props.onClick(e)}})}},{key:"render",value:function(){return r.a.createElement("div",{className:"board"},r.a.createElement("div",{className:"board-row"},this.renderSquare(0),this.renderSquare(1),this.renderSquare(2)),r.a.createElement("div",{className:"board-row"},this.renderSquare(3),this.renderSquare(4),this.renderSquare(5)),r.a.createElement("div",{className:"board-row"},this.renderSquare(6),this.renderSquare(7),this.renderSquare(8)))}}]),t}(r.a.Component),g="https://tic-tac-toe-server-capstone.herokuapp.com/",b="thingful-client-auth-token",E={saveAuthToken:function(e){window.sessionStorage.setItem(b,e)},getAuthToken:function(){return window.sessionStorage.getItem(b)},clearAuthToken:function(){window.sessionStorage.removeItem(b)},hasAuthToken:function(){return!!E.getAuthToken()},makeBasicAuthToken:function(e,t){return window.btoa("".concat(e,":").concat(t))}},k=E,y=(a(30),a(13));a(43),a(31);function j(e){var t=e.className,a=Object(y.a)(e,["className"]);return r.a.createElement("button",Object.assign({className:["Button",t].join(" ")},a))}function O(e){var t=e.className,a=Object(y.a)(e,["className"]);return r.a.createElement("input",Object.assign({className:["Input",t].join(" ")},a))}function N(e){var t=e.className,a=Object(y.a)(e,["className"]);return r.a.createElement("span",Object.assign({className:["Required",t].join(" ")},a),"*")}function _(e){var t=e.className,a=e.list,n=Object(y.a)(e,["className","list"]),s=["Section",a&&"Section--list",t].filter(Boolean).join(" ");return r.a.createElement("section",Object.assign({className:s},n))}var S=[[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]],w=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).newGame=function(){a.setState({history:[{squares:Array(9).fill(null)}],stepNumber:0,xIsNext:!0,endGame:!1})},a.state={history:[{squares:Array(9).fill(null)}],stepNumber:0,xIsNext:!0,endGame:!1},a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"calculateWinner",value:function(e){for(var t=0;t<S.length;t++){var a=Object(f.a)(S[t],3),n=a[0],r=a[1],s=a[2];if(e[n]&&e[n]===e[r]&&e[n]===e[s])return e[n]}return null}},{key:"saveGame",value:function(e){fetch("http://localhost:8000/api/users/game",{body:JSON.stringify({game:"X"===e}),method:"post",headers:{Authorization:"Bearer ".concat(k.getAuthToken()),"content-type":"application/json"}})}},{key:"handleClick",value:function(e){var t=this,a=this.state.history.slice(0,this.state.stepNumber+1),n=a[a.length-1].squares.slice();if(!0!==this.state.endGame&&!this.calculateWinner(n)&&!n[e]){n[e]=this.state.xIsNext?"X":"O";var r=this.calculateWinner(n),s=this.state.endGame;r&&(this.saveGame(r),s=!0),this.setState({endGame:s,history:a.concat([{squares:n}]),stepNumber:a.length,xIsNext:!this.state.xIsNext},(function(e){t.state.xIsNext||t.computerPlayer(n)}))}}},{key:"computerPlayer",value:function(e){var t=[];e.forEach((function(e,a){e||t.push(a)}));var a=[];e.forEach((function(e,t){"O"===e&&a.push(t)}));var n,r=Math.floor(Math.random()*t.length);S.forEach((function(e){var r=!1,s=0;e.forEach((function(e){a.forEach((function(t){t===e&&s++})),t.forEach((function(t){t===e&&(r=!0)}))})),s>0&&r&&(n=e)})),n&&n.forEach((function(e){var a=!1;t.forEach((function(t){t===e&&(a=!0)})),!0===a&&(r=e)})),console.log(n,r,t),this.handleClick(r)}},{key:"jumpTo",value:function(e){this.setState({stepNumber:e,xIsNext:e%2===0})}},{key:"render",value:function(){var e,t=this,a=this.state.history[this.state.stepNumber],n=this.calculateWinner(a.squares);return e=n?"Winner: "+n:"Your Move: "+(this.state.xIsNext?"X":"O"),r.a.createElement("div",{className:"game"},r.a.createElement("div",{className:"game-info"},r.a.createElement("div",null,e)),r.a.createElement("div",{className:"game-board"},r.a.createElement(v,{squares:a.squares,onClick:function(e){return t.handleClick(e)}})),this.state.endGame?r.a.createElement(j,{className:"new-game-btn",onClick:this.newGame},"new game"):"")}}]),t}(r.a.Component),L=(a(32),r.a.createContext({username:!1,setusername:function(){}})),C=function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(u.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).state={leaderboard:!0,registered:!1},a.handleLogoutClick=function(){a.context.setusername(),k.clearAuthToken()},a.handleLeaderboardClick=function(){a.setState({leaderboard:!a.state.leaderboard})},a.handleRegisterClick=function(){a.setState({registered:!a.state.registered})},a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"handleLeaderBoardButtons",value:function(){return this.state.leaderboard?this.renderLeaderBoardLink():this.context.username?this.renderLeaderBoardStartGame():this.renderLeaderBoardBackLink()}},{key:"renderHeaderButtons",value:function(){return console.log(this.context),this.context.username?this.renderLogoutLink():this.renderRegisterButtons()}},{key:"renderRegisterButtons",value:function(){return this.state.registered?this.renderRegisterBackLink():this.renderRegisterLink()}},{key:"renderLeaderBoardLink",value:function(){return r.a.createElement("div",{className:"leaderBoard"},r.a.createElement(c.b,{onClick:this.handleLeaderboardClick,to:"/leaderboard"},"Leaderboard"))}},{key:"renderLeaderBoardBackLink",value:function(){return r.a.createElement("div",{className:"Header__logged-in"},r.a.createElement(c.b,{onClick:this.handleLeaderboardClick,to:"/"},"Back"))}},{key:"renderLeaderBoardStartGame",value:function(){return r.a.createElement("div",{className:"Header__logged-in"},r.a.createElement(c.b,{onClick:this.handleLeaderboardClick,to:"/game"},"Game"))}},{key:"renderLogoutLink",value:function(){return r.a.createElement("div",{className:"Header__logged-in"},r.a.createElement(c.b,{onClick:this.handleLogoutClick,to:"/"},"Logout"))}},{key:"renderRegisterLink",value:function(){return r.a.createElement("div",{className:"Header__not-logged-in"},r.a.createElement(c.b,{onClick:this.handleRegisterClick,to:"/register"},"Register"))}},{key:"renderRegisterBackLink",value:function(){return r.a.createElement("div",{className:"Header__logged-in"},r.a.createElement(c.b,{onClick:this.handleRegisterClick,to:"/"},"Back"))}},{key:"render",value:function(){return console.log(this.context),r.a.createElement(r.a.Fragment,null,r.a.createElement("nav",{className:"Header"},r.a.createElement("div",{className:"title"},r.a.createElement("h1",null,"Tic-Tac-Toe Championship Edition")),r.a.createElement("div",{className:"button-box"},this.handleLeaderBoardButtons(),this.renderHeaderButtons())))}}]),t}(n.Component);C.contextType=L;var x={postLogin:function(e){return fetch("".concat(g,"/auth/login"),{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify(e)}).then((function(e){return e.ok?e.json():e.json().then((function(e){return Promise.reject(e)}))}))},postUser:function(e){return fetch("".concat(g,"/users"),{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify(e)}).then((function(e){return e.ok?e.json():e.json().then((function(e){return Promise.reject(e)}))}))}},B=(a(38),function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(u.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).state={error:null},a.handleSubmitJwtAuth=function(e){e.preventDefault(),a.setState({error:null});var t=e.target,n=t.user_name,r=t.password;console.log(n.value),a.context.setusername(n.value),x.postLogin({user_name:n.value,password:r.value}).then((function(e){n.value="",r.value="",k.saveAuthToken(e.authToken),a.props.onLoginSuccess()})).catch((function(e){a.setState({error:e.error})}))},a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){console.log(this.context);var e=this.state.error;return r.a.createElement("form",{className:"LoginForm",onSubmit:this.handleSubmitJwtAuth},r.a.createElement("div",{role:"alert"},e&&r.a.createElement("p",{className:"red"},e)),r.a.createElement("div",{className:"user_name"},r.a.createElement("label",{htmlFor:"LoginForm__user_name"},"User name"),r.a.createElement(O,{required:!0,name:"user_name",id:"LoginForm__user_name"})),r.a.createElement("div",{className:"password"},r.a.createElement("label",{htmlFor:"LoginForm__password"},"Password"),r.a.createElement(O,{required:!0,name:"password",type:"password",id:"LoginForm__password"})),r.a.createElement("div",{className:"Header__not-logged-in"}),r.a.createElement(j,{type:"submit"},"Login"))}}]),t}(n.Component));B.contextType=L,B.defaultProps={onLoginSuccess:function(){}};var q=function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(u.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).handleLoginSuccess=function(){var e=a.props,t=e.location,n=e.history,r=(t.state||{}).from||"/loggedin";n.push(r)},a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement(_,{className:"LoginPage"},r.a.createElement("h2",null,"Login to your account"),r.a.createElement(B,{onLoginSuccess:this.handleLoginSuccess}))}}]),t}(n.Component);q.defaultProps={location:{},history:{push:function(){}}};var R=function(e){function t(){return Object(i.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"logged-in"},r.a.createElement("form",null,r.a.createElement("h2",null,"Welcome back!"),r.a.createElement("h3",null,r.a.createElement("span",null,this.context.user_name)),r.a.createElement("p",null,"Welcome to Tic-Tac-Toe Championship Edition, Be the first player to connect your mark X or O in a row, rows can be vertical horizontal or diagonal, when all 9 squares are full the game is over."),r.a.createElement("div",{className:"Header__not-logged-in"},r.a.createElement(c.b,{to:"/game"},"Start Game"))))}}]),t}(n.Component);R.contextType=L;var A=R,T=(a(39),function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(u.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).state={error:null},a.handleSubmit=function(e){e.preventDefault();var t=e.target,n=t.full_name,r=t.user_name,s=t.password;a.setState({error:null}),x.postUser({user_name:r.value,password:s.value,full_name:n.value}).then((function(e){n.value="",r.value="",s.value="",a.props.onRegistrationSuccess()})).catch((function(e){a.setState({error:e.error})}))},a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.state.error;return r.a.createElement("form",{className:"RegistrationForm",onSubmit:this.handleSubmit},r.a.createElement("div",{role:"alert"},e&&r.a.createElement("p",{className:"red"},e)),r.a.createElement("div",{className:"full_name"},r.a.createElement("label",{htmlFor:"RegistrationForm__full_name"},"Full name ",r.a.createElement(N,null)),r.a.createElement(O,{name:"full_name",type:"text",required:!0,id:"RegistrationForm__full_name"})),r.a.createElement("div",{className:"user_name"},r.a.createElement("label",{htmlFor:"RegistrationForm__user_name"},"User name ",r.a.createElement(N,null)),r.a.createElement(O,{name:"user_name",type:"text",required:!0,id:"RegistrationForm__user_name"})),r.a.createElement("div",{className:"password"},r.a.createElement("label",{htmlFor:"RegistrationForm__password"},"Password ",r.a.createElement(N,null)),r.a.createElement(O,{name:"password",type:"password",required:!0,id:"RegistrationForm__password"})),r.a.createElement(j,{type:"submit"},"Submit"))}}]),t}(n.Component));T.defaultProps={onRegistrationSuccess:function(){}};var F=function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(u.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).handleRegistrationSuccess=function(e){a.props.history.push("/")},a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement(_,{className:"RegistrationPage"},r.a.createElement("h2",null,"Register"),r.a.createElement(T,{onRegistrationSuccess:this.handleRegistrationSuccess}))}}]),t}(n.Component);F.defaultProps={history:{push:function(){}}};a(40);var G=function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(u.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).state={data:[]},a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this;fetch("http://localhost:8000/api/users/leaderboard").then((function(e){return e.json()})).then((function(t){return e.setState({data:t})}))}},{key:"render",value:function(){return r.a.createElement("div",{className:"leaderBoard"},r.a.createElement("h2",{className:"high-score"},"HIGH SCORES"),r.a.createElement("ol",{className:"score-list"},this.state.data.map((function(e){return r.a.createElement("li",{key:e.id},r.a.createElement("span",null,e.user_name," ")," ",r.a.createElement("span",null,e.number_wins))}))))}}]),t}(n.Component),P=function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(u.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).state={hasError:!1,username:!1},a.setusername=function(e){a.setState({username:e})},a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement(L.Provider,{value:{username:this.state.username,setusername:this.setusername}},r.a.createElement("div",{className:"App"},r.a.createElement("header",{className:"App__header"},r.a.createElement(C,null)),r.a.createElement("main",{className:"App__main"},this.state.hasError&&r.a.createElement("p",{className:"red"},"There was an error! Oh no!"),r.a.createElement(d.c,null,r.a.createElement(d.a,{exact:!0,path:"/",component:q}),r.a.createElement(d.a,{path:"/loggedin",component:A}),r.a.createElement(d.a,{path:"/register",component:F}),r.a.createElement(d.a,{path:"/game",component:w}),r.a.createElement(d.a,{path:"/leaderboard",component:G})))))}}],[{key:"getDerivedStateFromError",value:function(e){return console.error(e),{hasError:!0}}}]),t}(n.Component);o.a.render(r.a.createElement(c.a,null,r.a.createElement(P,null)),document.getElementById("root"))}},[[24,1,2]]]);
//# sourceMappingURL=main.64597a35.chunk.js.map